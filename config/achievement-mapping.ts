/**
 * Achievement mapping (apiname) to individual games.
 * Manually maintained. Last updated: 2026-02-12
 */

export type GameKey =
  | "Kingdom Hearts Final Mix"
  | "Re:Chain of Memories"
  | "Kingdom Hearts II Final Mix"
  | "358/2 Days (cutscenes)"
  | "Birth by Sleep Final Mix"
  | "Re:Coded (cutscenes)"
  | "Dream Drop Distance HD"
  | "0.2 Birth by Sleep – A Fragmentary Passage"
  | "χ Back Cover (movie)"
  | "Kingdom Hearts III"
  | "Re Mind (DLC)";

export const MAPPING_1525: Record<string, GameKey> = {
  ACH_001: "Kingdom Hearts Final Mix",
  ACH_002: "Kingdom Hearts Final Mix",
  ACH_003: "Kingdom Hearts Final Mix",
  ACH_004: "Kingdom Hearts Final Mix",
  ACH_005: "Kingdom Hearts Final Mix",
  ACH_006: "Kingdom Hearts Final Mix",
  ACH_007: "Kingdom Hearts Final Mix",
  ACH_008: "Kingdom Hearts Final Mix",
  ACH_009: "Kingdom Hearts Final Mix",
  ACH_010: "Kingdom Hearts Final Mix",
  ACH_011: "Kingdom Hearts Final Mix",
  ACH_012: "Kingdom Hearts Final Mix",
  ACH_013: "Kingdom Hearts Final Mix",
  ACH_014: "Kingdom Hearts Final Mix",
  ACH_015: "Kingdom Hearts Final Mix",
  ACH_016: "Kingdom Hearts Final Mix",
  ACH_017: "Kingdom Hearts Final Mix",
  ACH_018: "Kingdom Hearts Final Mix",
  ACH_019: "Kingdom Hearts Final Mix",
  ACH_020: "Kingdom Hearts Final Mix",
  ACH_021: "Kingdom Hearts Final Mix",
  ACH_022: "Kingdom Hearts Final Mix",
  ACH_023: "Kingdom Hearts Final Mix",
  ACH_024: "Kingdom Hearts Final Mix",
  ACH_025: "Kingdom Hearts Final Mix",
  ACH_026: "Kingdom Hearts Final Mix",
  ACH_027: "Kingdom Hearts Final Mix",
  ACH_028: "Kingdom Hearts Final Mix",
  ACH_029: "Kingdom Hearts Final Mix",
  ACH_030: "Kingdom Hearts Final Mix",
  ACH_031: "Kingdom Hearts Final Mix",
  ACH_032: "Kingdom Hearts Final Mix",
  ACH_033: "Kingdom Hearts Final Mix",
  ACH_034: "Kingdom Hearts Final Mix",
  ACH_035: "Kingdom Hearts Final Mix",
  ACH_036: "Kingdom Hearts Final Mix",
  ACH_037: "Kingdom Hearts Final Mix",
  ACH_038: "Kingdom Hearts Final Mix",
  ACH_039: "Kingdom Hearts Final Mix",
  ACH_040: "Kingdom Hearts Final Mix",
  ACH_041: "Kingdom Hearts Final Mix",
  ACH_042: "Kingdom Hearts Final Mix",
  ACH_043: "Kingdom Hearts Final Mix",
  ACH_044: "Kingdom Hearts Final Mix",
  ACH_045: "Kingdom Hearts Final Mix",
  ACH_046: "Kingdom Hearts Final Mix",
  ACH_047: "Kingdom Hearts Final Mix",
  ACH_048: "Kingdom Hearts Final Mix",
  ACH_049: "Kingdom Hearts Final Mix",
  ACH_050: "Kingdom Hearts Final Mix",
  ACH_051: "Kingdom Hearts Final Mix",
  ACH_052: "Kingdom Hearts Final Mix",
  ACH_053: "Kingdom Hearts Final Mix",
  ACH_054: "Kingdom Hearts Final Mix",
  ACH_055: "Kingdom Hearts Final Mix",
  ACH_056: "Re:Chain of Memories",
  ACH_057: "Re:Chain of Memories",
  ACH_058: "Re:Chain of Memories",
  ACH_059: "Re:Chain of Memories",
  ACH_060: "Re:Chain of Memories",
  ACH_061: "Re:Chain of Memories",
  ACH_062: "Re:Chain of Memories",
  ACH_063: "Re:Chain of Memories",
  ACH_064: "Re:Chain of Memories",
  ACH_065: "Re:Chain of Memories",
  ACH_066: "Re:Chain of Memories",
  ACH_067: "Re:Chain of Memories",
  ACH_068: "Re:Chain of Memories",
  ACH_069: "Re:Chain of Memories",
  ACH_070: "Re:Chain of Memories",
  ACH_071: "Re:Chain of Memories",
  ACH_072: "Re:Chain of Memories",
  ACH_073: "Re:Chain of Memories",
  ACH_074: "Re:Chain of Memories",
  ACH_075: "Re:Chain of Memories",
  ACH_076: "Re:Chain of Memories",
  ACH_077: "Re:Chain of Memories",
  ACH_078: "Re:Chain of Memories",
  ACH_079: "Re:Chain of Memories",
  ACH_080: "Re:Chain of Memories",
  ACH_081: "Re:Chain of Memories",
  ACH_082: "Re:Chain of Memories",
  ACH_083: "Re:Chain of Memories",
  ACH_084: "Re:Chain of Memories",
  ACH_085: "Re:Chain of Memories",
  ACH_086: "Re:Chain of Memories",
  ACH_087: "Re:Chain of Memories",
  ACH_088: "Re:Chain of Memories",
  ACH_089: "Re:Chain of Memories",
  ACH_090: "Re:Chain of Memories",
  ACH_091: "Re:Chain of Memories",
  ACH_092: "Re:Chain of Memories",
  ACH_093: "Re:Chain of Memories",
  ACH_094: "Re:Chain of Memories",
  ACH_095: "Re:Chain of Memories",
  ACH_096: "Re:Chain of Memories",
  ACH_097: "Re:Chain of Memories",
  ACH_098: "Re:Chain of Memories",
  ACH_099: "Re:Chain of Memories",
  ACH_100: "Re:Chain of Memories",
  ACH_101: "Re:Chain of Memories",
  ACH_102: "Re:Chain of Memories",
  ACH_103: "Kingdom Hearts II Final Mix",
  ACH_104: "Kingdom Hearts II Final Mix",
  ACH_105: "Kingdom Hearts II Final Mix",
  ACH_106: "Kingdom Hearts II Final Mix",
  ACH_107: "Kingdom Hearts II Final Mix",
  ACH_108: "Kingdom Hearts II Final Mix",
  ACH_109: "Kingdom Hearts II Final Mix",
  ACH_110: "Kingdom Hearts II Final Mix",
  ACH_111: "Kingdom Hearts II Final Mix",
  ACH_112: "Kingdom Hearts II Final Mix",
  ACH_113: "Kingdom Hearts II Final Mix",
  ACH_114: "Kingdom Hearts II Final Mix",
  ACH_115: "Kingdom Hearts II Final Mix",
  ACH_116: "Kingdom Hearts II Final Mix",
  ACH_117: "Kingdom Hearts II Final Mix",
  ACH_118: "Kingdom Hearts II Final Mix",
  ACH_119: "Kingdom Hearts II Final Mix",
  ACH_120: "Kingdom Hearts II Final Mix",
  ACH_121: "Kingdom Hearts II Final Mix",
  ACH_122: "Kingdom Hearts II Final Mix",
  ACH_123: "Kingdom Hearts II Final Mix",
  ACH_124: "Kingdom Hearts II Final Mix",
  ACH_125: "Kingdom Hearts II Final Mix",
  ACH_126: "Kingdom Hearts II Final Mix",
  ACH_127: "Kingdom Hearts II Final Mix",
  ACH_128: "Kingdom Hearts II Final Mix",
  ACH_129: "Kingdom Hearts II Final Mix",
  ACH_130: "Kingdom Hearts II Final Mix",
  ACH_131: "Kingdom Hearts II Final Mix",
  ACH_132: "Kingdom Hearts II Final Mix",
  ACH_133: "Kingdom Hearts II Final Mix",
  ACH_134: "Kingdom Hearts II Final Mix",
  ACH_135: "Kingdom Hearts II Final Mix",
  ACH_136: "Kingdom Hearts II Final Mix",
  ACH_137: "Kingdom Hearts II Final Mix",
  ACH_138: "Kingdom Hearts II Final Mix",
  ACH_139: "Kingdom Hearts II Final Mix",
  ACH_140: "Kingdom Hearts II Final Mix",
  ACH_141: "Kingdom Hearts II Final Mix",
  ACH_142: "Kingdom Hearts II Final Mix",
  ACH_143: "Kingdom Hearts II Final Mix",
  ACH_144: "Kingdom Hearts II Final Mix",
  ACH_145: "Kingdom Hearts II Final Mix",
  ACH_146: "Kingdom Hearts II Final Mix",
  ACH_147: "Kingdom Hearts II Final Mix",
  ACH_148: "Kingdom Hearts II Final Mix",
  ACH_149: "Kingdom Hearts II Final Mix",
  ACH_150: "Kingdom Hearts II Final Mix",
  ACH_151: "Kingdom Hearts II Final Mix",
  ACH_152: "Kingdom Hearts II Final Mix",
  ACH_153: "Birth by Sleep Final Mix",
  ACH_154: "Birth by Sleep Final Mix",
  ACH_155: "Birth by Sleep Final Mix",
  ACH_156: "Birth by Sleep Final Mix",
  ACH_157: "Birth by Sleep Final Mix",
  ACH_158: "Birth by Sleep Final Mix",
  ACH_159: "Birth by Sleep Final Mix",
  ACH_160: "Birth by Sleep Final Mix",
  ACH_161: "Birth by Sleep Final Mix",
  ACH_162: "Birth by Sleep Final Mix",
  ACH_163: "Birth by Sleep Final Mix",
  ACH_164: "Birth by Sleep Final Mix",
  ACH_165: "Birth by Sleep Final Mix",
  ACH_166: "Birth by Sleep Final Mix",
  ACH_167: "Birth by Sleep Final Mix",
  ACH_168: "Birth by Sleep Final Mix",
  ACH_169: "Birth by Sleep Final Mix",
  ACH_170: "Birth by Sleep Final Mix",
  ACH_171: "Birth by Sleep Final Mix",
  ACH_172: "Birth by Sleep Final Mix",
  ACH_173: "Birth by Sleep Final Mix",
  ACH_174: "Birth by Sleep Final Mix",
  ACH_175: "Birth by Sleep Final Mix",
  ACH_176: "Birth by Sleep Final Mix",
  ACH_177: "Birth by Sleep Final Mix",
  ACH_178: "Birth by Sleep Final Mix",
  ACH_179: "Birth by Sleep Final Mix",
  ACH_180: "Birth by Sleep Final Mix",
  ACH_181: "Birth by Sleep Final Mix",
  ACH_182: "Birth by Sleep Final Mix",
  ACH_183: "Birth by Sleep Final Mix",
  ACH_184: "Birth by Sleep Final Mix",
  ACH_185: "Birth by Sleep Final Mix",
  ACH_186: "Birth by Sleep Final Mix",
  ACH_187: "Birth by Sleep Final Mix",
  ACH_188: "Birth by Sleep Final Mix",
  ACH_190: "Birth by Sleep Final Mix",
  ACH_191: "Birth by Sleep Final Mix",
  ACH_192: "Birth by Sleep Final Mix",
  ACH_193: "Birth by Sleep Final Mix",
  ACH_194: "Birth by Sleep Final Mix",
  ACH_195: "Birth by Sleep Final Mix",
  ACH_196: "Birth by Sleep Final Mix",
  ACH_197: "Birth by Sleep Final Mix",
  ACH_189: "Birth by Sleep Final Mix",
};

export const MAPPING_28: Record<string, GameKey> = {
  ACH_01: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_02: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_03: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_04: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_05: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_06: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_07: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_08: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_09: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_10: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_11: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_12: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_13: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_14: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_15: "0.2 Birth by Sleep – A Fragmentary Passage",
  ACH_16: "Dream Drop Distance HD",
  ACH_17: "Dream Drop Distance HD",
  ACH_18: "Dream Drop Distance HD",
  ACH_19: "Dream Drop Distance HD",
  ACH_20: "Dream Drop Distance HD",
  ACH_21: "Dream Drop Distance HD",
  ACH_22: "Dream Drop Distance HD",
  ACH_23: "Dream Drop Distance HD",
  ACH_24: "Dream Drop Distance HD",
  ACH_25: "Dream Drop Distance HD",
  ACH_26: "Dream Drop Distance HD",
  ACH_27: "Dream Drop Distance HD",
  ACH_28: "Dream Drop Distance HD",
  ACH_29: "Dream Drop Distance HD",
  ACH_30: "Dream Drop Distance HD",
  ACH_31: "Dream Drop Distance HD",
  ACH_32: "Dream Drop Distance HD",
  ACH_33: "Dream Drop Distance HD",
  ACH_34: "Dream Drop Distance HD",
  ACH_35: "Dream Drop Distance HD",
  ACH_36: "Dream Drop Distance HD",
  ACH_37: "Dream Drop Distance HD",
  ACH_38: "Dream Drop Distance HD",
  ACH_39: "Dream Drop Distance HD",
  ACH_40: "Dream Drop Distance HD",
  ACH_41: "Dream Drop Distance HD",
  ACH_42: "Dream Drop Distance HD",
  ACH_43: "Dream Drop Distance HD",
  ACH_44: "Dream Drop Distance HD",
  ACH_45: "Dream Drop Distance HD",
  ACH_46: "Dream Drop Distance HD",
  ACH_47: "Dream Drop Distance HD",
  ACH_48: "Dream Drop Distance HD",
  ACH_49: "Dream Drop Distance HD",
  ACH_50: "Dream Drop Distance HD",
  ACH_51: "Dream Drop Distance HD",
  ACH_52: "Dream Drop Distance HD",
  ACH_53: "Dream Drop Distance HD",
  ACH_54: "Dream Drop Distance HD",
  ACH_55: "Dream Drop Distance HD",
  ACH_56: "Dream Drop Distance HD",
  ACH_57: "Dream Drop Distance HD",
  ACH_58: "Dream Drop Distance HD",
  ACH_59: "Dream Drop Distance HD",
  ACH_60: "Dream Drop Distance HD",
  ACH_61: "Dream Drop Distance HD",
  ACH_62: "Dream Drop Distance HD",
  ACH_63: "Dream Drop Distance HD",
  ACH_64: "Dream Drop Distance HD",
  ACH_65: "Dream Drop Distance HD",
  ACH_66: "Dream Drop Distance HD",
  ACH_67: "Dream Drop Distance HD",
  ACH_68: "Dream Drop Distance HD",
  ACH_69: "Dream Drop Distance HD",
};

export const MAPPING_KH3: Record<string, GameKey> = {
  ACH_01: "Kingdom Hearts III",
  ACH_02: "Kingdom Hearts III",
  ACH_03: "Kingdom Hearts III",
  ACH_04: "Kingdom Hearts III",
  ACH_05: "Kingdom Hearts III",
  ACH_06: "Kingdom Hearts III",
  ACH_07: "Kingdom Hearts III",
  ACH_08: "Kingdom Hearts III",
  ACH_09: "Kingdom Hearts III",
  ACH_10: "Kingdom Hearts III",
  ACH_11: "Kingdom Hearts III",
  ACH_12: "Kingdom Hearts III",
  ACH_13: "Kingdom Hearts III",
  ACH_14: "Kingdom Hearts III",
  ACH_15: "Kingdom Hearts III",
  ACH_16: "Kingdom Hearts III",
  ACH_17: "Kingdom Hearts III",
  ACH_18: "Kingdom Hearts III",
  ACH_19: "Kingdom Hearts III",
  ACH_20: "Kingdom Hearts III",
  ACH_21: "Kingdom Hearts III",
  ACH_22: "Kingdom Hearts III",
  ACH_23: "Kingdom Hearts III",
  ACH_24: "Kingdom Hearts III",
  ACH_25: "Kingdom Hearts III",
  ACH_26: "Kingdom Hearts III",
  ACH_27: "Kingdom Hearts III",
  ACH_28: "Kingdom Hearts III",
  ACH_29: "Kingdom Hearts III",
  ACH_30: "Kingdom Hearts III",
  ACH_31: "Kingdom Hearts III",
  ACH_32: "Kingdom Hearts III",
  ACH_33: "Kingdom Hearts III",
  ACH_34: "Kingdom Hearts III",
  ACH_35: "Kingdom Hearts III",
  ACH_36: "Kingdom Hearts III",
  ACH_37: "Kingdom Hearts III",
  ACH_38: "Kingdom Hearts III",
  ACH_39: "Kingdom Hearts III",
  ACH_40: "Kingdom Hearts III",
  ACH_41: "Kingdom Hearts III",
  ACH_42: "Kingdom Hearts III",
  ACH_43: "Kingdom Hearts III",
  ACH_44: "Kingdom Hearts III",
  ACH_45: "Kingdom Hearts III",
  ACH_46: "Re Mind (DLC)",
  ACH_47: "Re Mind (DLC)",
  ACH_48: "Re Mind (DLC)",
  ACH_49: "Re Mind (DLC)",
  ACH_50: "Re Mind (DLC)",
  ACH_51: "Re Mind (DLC)",
};

/** Fallback heuristic when apiname is not in the mapping */
export function guessGameFromAchievement(
  appId: number,
  apiname: string,
  displayName: string,
  description: string,
): GameKey | null {
  const name = (displayName || "").toLowerCase();
  const desc = (description || "").toLowerCase();
  const api = apiname.toLowerCase();

  if (appId === 2552430) {
    if (
      /sora|riku|card (master|collection|breaker|deck)|castle oblivion|d report|veggie|balloon glider|tigger|whirlwind plunge|bumble|moogle|room creator|duel master|sleight|woven memories|truth.*castle|confronting the darkness|challenge from the inner|overcoming the darkness|card of memories|slumber to remember|road to dawn|no escape|premium card|novice deck|expert deck|interceptor|tightrope|battle card collector/i.test(
        name + desc,
      ) ||
      /^com_|^rec_|rechain|chain of memories/i.test(api)
    )
      return "Re:Chain of Memories";
    if (
      /terra|ventus|aqua|unversed|mirage arena|command board|vanitas|ice cream beat|shotlock|rumble racing|fruitball|eraqus|no heart|secret episode|final episode|shot lock|break time|the adventurer|the warrior|the vessel|the dormant|the seeker|musclehead|b-boy|majorette|the lost chapter|connected.*hearts|pawn of the arena|knight of the arena|queen of the arena|king of the arena|keepers of the arena|villains' vendetta|pâtissier|maestro|rapid racer|fantasista|vanitas remnant|unknown|light's will|darkness's will/i.test(
        name + desc,
      ) ||
      /^bbs_|^bbs-/i.test(api)
    )
      return "Birth by Sleep Final Mix";
    if (
      /roxas|summer's end|lingering will|organization xiii|paradox cup|pain and panic|cerberus paradox|titan paradox|hades paradox|goddess of fate|land of dragons|beast's castle|port royal|pride lands|space paranoids|mushroom xiii|reunion|my hero|corroded by darkness|timeless river|ambitious adventurer|nobody know-it-all|heartless highbrow|limit master|craftsman|seeker|minigame maniac|puzzler|navigator|conqueror|struggle champion|pro skater|to rule them all/i.test(
        name + desc,
      ) ||
      /^kh2_|^kh2-|^khii/i.test(api)
    )
      return "Kingdom Hearts II Final Mix";

    return "Kingdom Hearts Final Mix";
  }
  if (appId === 2552440) {
    if (
      /fragmentary|0\.2|aqua.*passage| Episode 0/i.test(name + desc) ||
      /^02_|^0_2|fragmentary/i.test(api)
    )
      return "0.2 Birth by Sleep – A Fragmentary Passage";
    if (
      /back cover|foreteller|keyblade war|χ |chi back|braig|luxu|master of masters/i.test(
        name + desc,
      ) ||
      /backcover|back_cover|chirithy|foreteller/i.test(api)
    )
      return "χ Back Cover (movie)";

    return "Dream Drop Distance HD";
  }
  if (appId === 2552450) {
    if (
      /re mind|re:mind|limitcut|yozora|data greeting|remind|re\\s*mind/i.test(
        name + desc,
      ) ||
      /remind|re_mind|limitcut|yozora|dlc/i.test(api)
    )
      return "Re Mind (DLC)";

    return "Kingdom Hearts III";
  }

  return null;
}

export function getGameForAchievement(
  appId: number,
  apiname: string,
  displayName: string,
  description: string,
): GameKey | null {
  let map;

  if (appId === 2552430) map = MAPPING_1525;
  else if (appId === 2552440) map = MAPPING_28;
  else if (appId === 2552450) map = MAPPING_KH3;
  if (map && map[apiname]) return map[apiname];

  return guessGameFromAchievement(appId, apiname, displayName, description);
}
